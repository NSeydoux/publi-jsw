\begin{tikzpicture}
	\input{figures/topologies/illustration_edrpt.tikz}
	
	\begin{pgfonlayer}{background}
	
	% Bubbles
	\draw[gray,fill=gray,dashed,fill opacity=0.2]([yshift=1mm]r111.north) 
	to[closed,curve through={(r111.east) .. ([yshift=-1mm]acti111.south) .. ([yshift=-1mm]lumi111.south) .. ([yshift=-1mm]pres111.south) .. (r111.west)}]([yshift=1mm]r111.north);
	
	\draw[gray,fill=gray,dashed,fill opacity=0.2]([yshift=1mm]r112.north) 
	to[closed,curve through={(r112.east) ..  ([yshift=-1mm]acti112.south) .. ([yshift=-1mm]lumi112.south) .. ([yshift=1mm]pres112.south) .. (r112.west)}]([yshift=1mm]r112.north);
	
%	\draw[gray,fill=gray,dashed,fill opacity=0.2](g110.north)
%	to[closed,curve through={(g110.east) .. (acti112.east) .. (acti112.south) .. (pres111.south) .. (pres111.west).. (g110.west) .. (g110.west) }](g110.north);
	
	\draw[gray,fill=gray,dashed,fill opacity=0.2](g120.north) 
	to[closed,curve through={(r122.east).. (lumi122.south) .. (acti121.south) .. (r121.west)}](g120.north);
	
	\draw[gray,fill=gray,dashed,fill opacity=0.2]([yshift=1mm]r121.north) 
	to[closed,curve through={(r121.east) .. ([yshift=-1mm]pres121.south) .. ([yshift=-1mm]acti121.south) .. (r121.west)}]([yshift=1mm]r121.north);
	
	\draw[gray,fill=gray,dashed,fill opacity=0.2]([yshift=1mm]r122.north) 
	to[closed,curve through={(r122.east) .. ([yshift=-1mm]lumi122.south) .. ([yshift=-1mm]acti122.south) .. (r122.west)}]([yshift=1mm]r122.north);
	
	% Labels 
	\draw[dashed] ([yshift=-5mm]lumi111.south west) node [below] {M111 context} -- ([xshift=1mm, yshift=1.5mm]lumi111.south west);
	\draw[dashed] ([xshift=-2mm,yshift=-2mm]lumi112.south east) node [below] {M112 context} -- ([xshift=-1mm, yshift=1.5mm]lumi112.south east);
	\draw[dashed] ([xshift=4mm,yshift=-6mm]acti121.south west) node [below] {M121 context} -- ([xshift=7mm, yshift=1.5mm]acti121.south west);
	\draw[dashed] ([yshift=-5mm]acti122.south east) node [below] {M122 context} -- ([xshift=-1mm, yshift=1.5mm]acti122.south east);
%	\draw[dashed] ([yshift=20mm]r111.north west) node [above] {C110 context} -- ([yshift=4mm]r111.north);
	\draw[dashed] ([xshift=5mm,yshift=8mm]g120.north) node [above] {C120 context} -- ([xshift=6mm,yshift=-3.5mm]g120.south east);
	
%	\draw[gray,fill=gray,dashed,fill opacity=0.2](g110.north)
%	to[closed,curve through={(g110.west) .. (ther110.west) .. (ther110.south) .. ([xshift=-3mm]r112.west) .. (lumi112.north) .. (temp112.west) .. (temp112.south) .. (temp112.east)  ..  (r112.east) .. ([yshift=2mm]g110.east) }](g110.north);
	
%	\draw[gray,fill=gray,dashed,fill opacity=0.2](g110.north)
%	to[closed,curve through={([yshift=2mm]g110.west) .. (r111.west) .. (temp111.west) .. (temp111.south) .. (temp111.east) .. (lumi111.north) .. ([yshift=-3mm]r111.south east) .. ([yshift=-3mm]r112.south west) .. (lumi112.north) .. (temp112.west) .. (temp112.south) .. (temp112.east)  ..  (r112.east) .. ([yshift=2mm]g110.east) }](g110.north);
	\end{pgfonlayer}
	
\end{tikzpicture}

	



